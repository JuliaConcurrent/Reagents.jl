<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · Reagents</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Reagents</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Reagents.jl</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/treiberstack/">Treiber stack</a></li><li><a class="tocitem" href="../../tutorials/msqueue/">Michael and Scott queue</a></li><li><a class="tocitem" href="../../tutorials/cancellablecontainers/">Cancellable containers</a></li><li><a class="tocitem" href="../../tutorials/catalysts/">Catalysts</a></li></ul></li><li><span class="tocitem">Reference</span><ul><li class="is-active"><a class="tocitem" href>API</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/tkf/Reagents.jl/blob/master/docs/src/reference/api.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Reagents.jl is still work-in-progress.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="Reagents.CAS" href="#Reagents.CAS"><code>Reagents.CAS</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Reagents.CAS(ref::Reagents.Ref{T}, expected::T, desired::T)</code></pre><p>A reagent for replacing the value in <code>ref</code> from <code>expected</code> to <code>desired</code>. Multiple CAS reagents are committed atomically.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; ref1 = Reagents.Ref(111);

julia&gt; ref2 = Reagents.Ref(222);

julia&gt; reagent = Reagents.CAS(ref1, 111, -1) ⨟ Reagents.CAS(ref2, 222, -2);

julia&gt; reagent();

julia&gt; ref1[]
-1

julia&gt; ref2[]
-2</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L82">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Reagents.PostCommit" href="#Reagents.PostCommit"><code>Reagents.PostCommit</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Reagents.PostCommit(f)</code></pre><p>Run <code>f(output)</code> when the reagent successfully completed its reaction with <code>output</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; ref = Reagents.Ref(111);

julia&gt; reagent = Reagents.Read(ref) ⨟ Reagents.PostCommit(x -&gt; @show(x));

julia&gt; reagent();
x = 111</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L75">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Reagents.Read" href="#Reagents.Read"><code>Reagents.Read</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Reagents.Read(ref::Reagents.Ref)</code></pre><p>A reagent that reads the value in <code>ref</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; ref = Reagents.Ref(111);

julia&gt; reagent = Reagents.Read(ref);

julia&gt; reagent()
111</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Reagents.Reagent" href="#Reagents.Reagent"><code>Reagents.Reagent</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Reagents.Reagent</code></pre><p>Composable description for nonblocking and synchronous operations.</p><p>Reagents can be composed with <code>∘</code> although it is recommended to use the opposite composition operator <code>⨟</code>.  A composed Reagent can be called, just like a function, to actually execute the side-effects.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; reagent = Reagents.Return(1) ⨟ Reagents.Map(string);

julia&gt; reagent()
&quot;1&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L76">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Reagents.Ref" href="#Reagents.Ref"><code>Reagents.Ref</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Reagents.Ref{T}()
Reagents.Ref{T}(value::T)</code></pre><p>Create a reference storing a value of type <code>T</code>.</p><p>Use reagents such as <a href="#Reagents.Update"><code>Reagents.Update</code></a>, <a href="#Reagents.CAS"><code>Reagents.CAS</code></a>, and <a href="#Reagents.Read"><code>Reagents.Read</code></a> to manipulate</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; ref = Reagents.Ref{Int}();

julia&gt; ref[] = 111;

julia&gt; ref[]
111

julia&gt; Reagents.try(Reagents.CAS(ref, 111, 222)) !== nothing
true

julia&gt; ref[]
222</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Reagents.Update" href="#Reagents.Update"><code>Reagents.Update</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Reagents.Update(f, ref::Reagents.Ref{T})</code></pre><p>Given a function of form <code>(v::T, a) -&gt; (w::T, b)</code> and a <a href="#Reagents.Ref"><code>Reagents.Ref</code></a> holding a value of type <code>T</code>, update its value to <code>w</code> and pass the output <code>b</code> to the downstream reagent. The function <code>f</code> receives the value <code>v</code> in <code>ref</code> and the output of <code>a</code> of the upstream reagent.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; ref = Reagents.Ref(0);

julia&gt; add! = Reagents.Update((v, a) -&gt; (v + a, v), ref);

julia&gt; add!(1)  # add 1 and return the old value
0

julia&gt; add!(2)
1

julia&gt; ref[]
3</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L83">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CompositionsBase.:⨟" href="#CompositionsBase.:⨟"><code>CompositionsBase.:⨟</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">r1 ⨟ r2
r2 ∘ r1</code></pre><p>The operator <code>⨟</code> (<code>\bbsemi</code>) sequences reagents. The composition <code>r1 ⨟ r2</code> means to invoke <code>r1</code> and also <code>r2</code> with the output of <code>r1</code>. Note that the entire reaction is still done atomically.</p><p>The syntaxes <code>r1 ⨟ r2</code> and <code>r2 ∘ r1</code> are equivalent. It is recommended to use <code>r1 ⨟ r2</code> to clarify the top-to-down data flow when the reagent definition spans multiple lines. However, knowing that <code>r1 ⨟ r2</code> is equivalent to <code>r2 ∘ r1</code>  can be useful for remember that, in the reaction <code>(r2 ∘ r1)(x)</code>, the reagent <code>r1</code> is the one that sees the input <code>x</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; ref = Reagents.Ref(111);

julia&gt; r1 = Reagents.Read(ref);

julia&gt; r2 = Reagents.Map(string);

julia&gt; (r1 ⨟ r2)()
&quot;111&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Reagents.:&amp;" href="#Reagents.:&amp;"><code>Reagents.:&amp;</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">r1 &amp; r2</code></pre><p>The pairing combinator. Both reagents <code>r1</code> and <code>r2</code> are executed and the downstream reagent receives the tuple <code>(y1, y2)</code> where <code>y1</code> is the output of <code>r1</code> and <code>y2</code> is the output of <code>r2</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; ref1 = Reagents.Ref(111);

julia&gt; ref2 = Reagents.Ref(222);

julia&gt; r1 = Reagents.Read(ref1);

julia&gt; r2 = Reagents.Read(ref2);

julia&gt; (r1 &amp; r2)()
(111, 222)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Reagents.:|" href="#Reagents.:|"><code>Reagents.:|</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">r1 | r2</code></pre><p>The choice combinator. Invokes the reaction of one and exactly one reagent.  The choice is left-biased; i.e., <code>r1 | r2</code> tries <code>r1</code> first and then try <code>r2</code>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; ref1 = Reagents.Ref(111);

julia&gt; ref2 = Reagents.Ref(222);

julia&gt; r1 = Reagents.CAS(ref1, -1, 0);  # will fail (wrong expected old value)

julia&gt; r2 = Reagents.CAS(ref2, 222, 333);  # will succeed

julia&gt; (r1 | r2)();

julia&gt; ref1[]
111

julia&gt; ref2[]
333</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Reagents.channel" href="#Reagents.channel"><code>Reagents.channel</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Reagents.channel(A::Type, B::Type = A) -&gt; (a2b, b2a)</code></pre><p>Create a pair of swap endpoints for exchanging a value <code>a</code> of type <code>A</code> and a value <code>b</code> of type <code>B</code> <em>synchronously</em>.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; a2b, b2a = Reagents.channel(Int, Symbol);

julia&gt; t = @async b2a(:hello);

julia&gt; a2b(123)
:hello

julia&gt; fetch(t)
123</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Reagents.dissolve" href="#Reagents.dissolve"><code>Reagents.dissolve</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Reagents.dissolve(catalyst::Reagent)</code></pre><p>Register <code>catalyst</code> as a persistent reagent that helps other reaction.</p><p>The reagent <code>catalyst</code> must include a blocking reagent (i.e., <a href="#Reagents.channel"><code>Reagents.channel</code></a>).</p><p><strong>Examples</strong></p><p><code>Reagents.dissolve</code> is useful when associating multiple channels:</p><pre><code class="language-julia-repl hljs">julia&gt; using Reagents

julia&gt; send1, receive1 = Reagents.channel(Int, Nothing)
       send2, receive2 = Reagents.channel(Char, Nothing)
       sendall, receiveall = Reagents.channel(Tuple{Int,Char}, Nothing);

julia&gt; catalyst = (receive1 &amp; receive2) ⨟ sendall;

julia&gt; Reagents.dissolve(catalyst);

julia&gt; @sync begin
           @async send1(1)
           @async send2(&#39;a&#39;)
           receiveall()
       end
(1, &#39;a&#39;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Reagents.try" href="#Reagents.try"><code>Reagents.try</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Reagents.try(reagent::Reagent, [value = nothing])</code></pre><p>Invoke <code>reagent</code> with <code>value</code>. If it succeeds with an <code>output</code>, return <code>Some(output)</code>. If it is blocked, return <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tkf/Reagents.jl/blob/292bd0ae5fec922d96707d8639253d7ac29d5f7c/src/utils.jl#L57-L62">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorials/catalysts/">« Catalysts</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.5 on <span class="colophon-date" title="Wednesday 11 August 2021 01:06">Wednesday 11 August 2021</span>. Using Julia version 1.7.0-beta3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
